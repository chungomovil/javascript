<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejercicio 27</title>
</head>
<body>
    <script>
        /* Programa una clase llamada Pelicula.

        La clase recibirá un objeto al momento de instanciarse con los siguentes datos: id de la película en IMDB, titulo, director, año de estreno, país o países de origen, géneros y calificación en IMBD.
            - Todos los datos del objeto son obligatorios.
            - Valida que el id IMDB tenga 9 caracteres, los primeros 2 sean letras y los 
                7 restantes números.
            - Valida que el título no rebase los 100 caracteres.
            - Valida que el director no rebase los 50 caracteres.
            - Valida que el año de estreno sea un número entero de 4 dígitos.
            - Valida que el país o paises sea introducidos en forma de arreglo.
            - Valida que los géneros sean introducidos en forma de arreglo.
            - Valida que los géneros introducidos esten dentro de los géneros 
                aceptados*.
            - Crea un método estático que devuelva los géneros aceptados*.
            - Valida que la calificación sea un número entre 0 y 10 pudiendo ser 
                decimal de una posición.
            - Crea un método que devuelva toda la ficha técnica de la película.
            - Apartir de un arreglo con la información de 3 películas genera 3 
                instancias de la clase de forma automatizada e imprime la ficha técnica 
                de cada película.

    * Géneros Aceptados: Action, Adult, Adventure, Animation, Biography, Comedy, Crime, Documentary ,Drama, Family, Fantasy, Film Noir, Game-Show, History, Horror, Musical, Music, Mystery, News, Reality-TV, Romance, Sci-Fi, Short, Sport, Talk-Show, Thriller, War, Western.*/
    
    class Pelicula {

        constructor(id, titulo, director, estreno, pais, genero, calificacion) {
            this.id = id,
            this.titulo = titulo,
            this.director = director,
            this.estreno = estreno,
            this.pais = pais,
            this.genero = genero,
            this.calificacion = calificacion
        }

        static generos () {
            let textoGeneros = "Action, Adult, Adventure, Animation, Biography, Comedy, Crime, Documentary ,Drama, Family, Fantasy, Film Noir, Game-Show, History, Horror, Musical, Music, Mystery, News, Reality-TV, Romance, Sci-Fi, Short, Sport, Talk-Show, Thriller, War, Western".toLowerCase();
            const listaGeneros = textoGeneros.split(",");
            return listaGeneros;
        }
    }

    const validarEntrada = entradas => {
        const [id, titulo, director, estreno, pais=[], genero=[], calificacion] = entradas;
        if(entradas.some(elemento => elemento.length === 0)) return "Alguno de los campos esta vacio"; //COMPROBAMOS QUE NINGUNO DE LOS ELEMENTOS DEL ARRAY ESTE VACIO CON ESTE METODO QUE DEVUELVE TRUE O FALSE
        if(!/^[a-zA-Z]{2}\d{7}$/.test(id)) return "El formato del id no es correcto.";
        if(titulo.length >= 100) return "La longitud del titulo no puede ser mayor a 100 caracteres";
        if(director.length <2 || director.length >= 50) return "La longitud del director debe estar comprendida entre 2 y 50 caracteres";
        if(!/\d{4}/.test(estreno) || (estreno < 1900 || estreno > 2050)) return "La fecha de estreno es incorrecta.";
        if(pais) {
            pais[0] = pais[0].replaceAll(" ", "").split(",");
        }
        if(genero) {
            genero[0] = genero[0].toLowerCase().replaceAll(" ","").split(",");
            if(!genero[0].some(elemento => Pelicula.generos().includes(elemento))) return "El genero no es valido";
        }
        if(calificacion) {
            (/^\D+$/.test(calificacion)) ? calificacion=parseFloat(calificacion).toFixed(1) : "La calificacion debe estar comprendida entre 0 y 10";
        }
        return [id, titulo, director, estreno, pais, genero, calificacion];
    }

    const campos = ["id --> En formato IMBD", "titulo", "director", "anio de estreno", "pais(es) de origen", "genero(s)", "calificacion"];
    alert(`INSCRIBIR PELICULA:\n***CAMPOS OBLIGATORIOS*** ${campos.map(elemento => "\n- "+elemento)}`);
    const entradas = [];
    for(let campo of campos.keys()) {
        if (campo === 4 || campo === 5) {
            let entrada = prompt(`${campos[campo].toUpperCase()} (SEPARAR POR "," LOS DISTINTOS VALORES)`);
            entradas.push([entrada])
        }
        else {
            let entrada = prompt(`${campos[campo].toUpperCase()}`);
            entradas.push(entrada);
        }
    }
    alert(validarEntrada(entradas));
    
    </script>
</body>
</html>